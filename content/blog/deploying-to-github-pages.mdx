---
title: "Next.js 정적 사이트를 GitHub Pages에 배포하기"
description: "Next.js 16 + GitHub Actions로 정적 사이트를 GitHub Pages에 자동 배포하는 전체 과정 정리"
date: "2026-02-13"
tags: ["Next.js", "GitHub Pages", "GitHub Actions", "배포", "CI/CD"]
aiTools: ["Claude Code"]
published: true
relatedProject: "ai-portfolio"
---

## 개요

이 포트폴리오 사이트를 GitHub Pages에 배포하면서 겪은 과정을 정리합니다.
Next.js의 정적 export 기능과 GitHub Actions를 조합하면 무료로 자동 배포 파이프라인을 구축할 수 있습니다.

## Next.js 정적 export 설정

### next.config.ts

```typescript
const nextConfig: NextConfig = {
  output: "export",          // 정적 HTML 생성
  basePath: "/ai-portfolio", // GitHub Pages 경로
  trailingSlash: true,       // /blog/ 형태 (404 방지)
  images: {
    unoptimized: true,       // 정적 export에서는 이미지 최적화 불가
  },
};
```

### 주의사항

`output: 'export'` 모드에서는 몇 가지 제한이 있습니다:

1. **Route Handlers 사용 불가**: `robots.ts`, `sitemap.ts` 같은 파일은 런타임에 실행되므로 정적 export와 호환되지 않습니다
2. **이미지 최적화 불가**: `next/image`의 최적화 기능 대신 `unoptimized: true` 필수
3. **동적 라우트**: 모든 동적 경로에 `generateStaticParams` 필수

### robots.txt & sitemap.xml 해결

Route Handler 대신 정적 파일로 처리했습니다:

- `public/robots.txt`: 직접 작성
- `public/sitemap.xml`: 빌드 스크립트로 자동 생성

```json
{
  "scripts": {
    "prebuild": "node scripts/generate-sitemap.mjs",
    "build": "next build"
  }
}
```

`prebuild`는 `build` 전에 자동 실행되므로, 빌드할 때마다 최신 sitemap이 생성됩니다.

## GitHub Actions 워크플로우

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [master]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm
      - run: npm ci
      - run: npm run build
      - uses: actions/upload-pages-artifact@v3
        with:
          path: out

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - id: deployment
        uses: actions/deploy-pages@v4
```

핵심 포인트:
- `permissions`에 `pages: write`와 `id-token: write` 필수
- `upload-pages-artifact`로 `out/` 디렉토리 업로드
- `deploy-pages`로 GitHub Pages에 배포

## GitHub Pages 활성화

GitHub CLI로 Pages를 활성화했습니다:

```bash
gh api repos/{owner}/{repo}/pages \
  -X POST \
  -f build_type=workflow \
  -f source[branch]=master \
  -f source[path]="/"
```

`build_type=workflow`로 설정하면 GitHub Actions가 배포를 담당합니다.

## gh CLI 인증 팁

`.github/workflows/` 파일을 push하려면 `workflow` 스코프가 필요합니다:

```bash
# 기본 인증
gh auth login --web --git-protocol https

# workflow 스코프 추가
gh auth refresh -h github.com -s workflow
```

이걸 모르면 push 시 `refusing to allow an OAuth App to create or update workflow` 에러가 발생합니다.

## 빌드 결과 확인

```bash
npm run build
```

성공하면 `out/` 디렉토리에 정적 파일이 생성됩니다:

```
out/
├── index.html          # 홈
├── projects/
│   ├── index.html      # 프로젝트 목록
│   ├── batch-app/      # 프로젝트 상세
│   └── ai-portfolio/
├── blog/
│   ├── index.html      # 블로그 목록
│   └── hello-world/    # 블로그 상세
├── about/
├── robots.txt
└── sitemap.xml
```

## 배운 점

- Next.js 정적 export는 간단하지만 제약을 미리 파악해야 한다
- GitHub Actions + Pages 조합은 무료이면서 강력한 CI/CD 파이프라인
- `gh` CLI로 리포지토리 생성부터 Pages 설정까지 터미널에서 모두 처리 가능
- `workflow` 스코프 누락은 흔한 실수 — 에러 메시지를 잘 읽자
